<script>
(function () {
    this._global || (this._global = {});
    this._global.channel = 'MessagesChannel';
    this._global.conversationId = '<%= @conversation.id %>';
}).call(this);
</script>

<div class="conversation">
    <div class="conversation-view" >
      <%= render @conversation.messages %>
    </div>

    <div class="conversation-form">
        <%= form_for :message do |f| %>
          <%= f.text_area :body, class: 'form-control' %>
          <%= hidden_field_tag "message[user_id]", current_user.id %>
          <%= hidden_field_tag "message[conversation_id]", @conversation.id %>
        <% end %>
    </div>
</div>

<script type="text/javascript">
  (function () {
    var view = document.querySelector('.conversation-view');
    view.scrollTop = view.scrollHeight;
  }).call(this);
</script>

<%= javascript_pack_tag 'conversation' %>
